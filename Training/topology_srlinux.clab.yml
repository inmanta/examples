name: training
mgmt:
  network: inmanta_mgmt
  ipv4_subnet: 10.0.0.0/24
topology:
  nodes:
    R1:
      kind: srl 
      type: ixrd2
      image: ghcr.io/nokia/srlinux
      mgmt_ipv4: 10.0.0.5
    C1:
      kind: linux
      image: praqma/network-multitool:latest
      mgmt_ipv4: 10.0.0.205
      entrypoint: /bin/bash
      cmd: /opt/config_ip 10.0.1.2 eth1 10.0.1.1 30
      binds:
        - ./resources/Clients/:/opt/
    R2:
      kind: srl
      type: ixrd2
      image: ghcr.io/nokia/srlinux 
      mgmt_ipv4: 10.0.0.6
    C2:
      kind: linux
      image: praqma/network-multitool:latest
      mgmt_ipv4: 10.0.0.206
      entrypoint: /bin/bash
      cmd: /opt/config_ip 10.0.2.2 eth1 10.0.2.1 30
      binds:
        - ./resources/Clients/:/opt/
    R3:
      kind: srl
      type: ixrd2 
      image: ghcr.io/nokia/srlinux 
      mgmt_ipv4: 10.0.0.7
    C3:
      kind: linux
      image: praqma/network-multitool:latest
      mgmt_ipv4: 10.0.0.207
      entrypoint: /bin/bash
      cmd: /opt/config_ip 10.0.3.2 eth1 10.0.3.1 30
      binds:
        - ./resources/Clients/:/opt/
    R4:
      kind: srl 
      type: ixrd2
      image: ghcr.io/nokia/srlinux 
      mgmt_ipv4: 10.0.0.8
    C4:
      kind: linux
      image: praqma/network-multitool:latest
      mgmt_ipv4: 10.0.0.208
      entrypoint: /bin/bash
      cmd: /opt/config_ip 10.0.4.2 eth1 10.0.4.1 30
      binds:
        - ./resources/Clients/:/opt/
    pgmaster:
      kind: linux
      image: postgres:14
      env:
        POSTGRES_USER: inmanta
        POSTGRES_PASSWORD: inmanta
      mgmt_ipv4: 10.0.0.100
    orchestrator:
      kind: linux
      image: ghcr.io/inmanta/orchestrator:dev
      binds:
        - ./resources/inmanta.cfg:/etc/inmanta/inmanta.cfg
      cmd: server --wait-for-host clab-training-pgmaster --wait-for-port 5432
      mgmt_ipv4: 10.0.0.102
  links:
    - endpoints: ["R1:e1-1", "R2:e1-1"]
    - endpoints: ["R1:e1-2", "R3:e1-1"]
    - endpoints: ["R1:e1-3", "R4:e1-1"]
    - endpoints: ["R2:e1-2", "R3:e1-2"]
    - endpoints: ["R2:e1-3", "R4:e1-2"]
    - endpoints: ["R3:e1-3", "R4:e1-3"]
    - endpoints: ["C1:eth1", "R1:e1-4"]
    - endpoints: ["C2:eth1", "R2:e1-4"]
    - endpoints: ["C3:eth1", "R3:e1-4"]
    - endpoints: ["C4:eth1", "R4:e1-4"]
